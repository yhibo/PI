Allocated GPU(s) with id(s):  0 1 2
Setting CUDA_VISIBLE_DEVICES=0,1,2
Setting NV_GPU=0,1,2
2022-09-20 23:43:16.516346: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2022-09-20 23:43:19.545798: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:3e:00.0 name: NVIDIA GeForce RTX 3080 computeCapability: 8.6
coreClock: 1.71GHz coreCount: 68 deviceMemorySize: 9.78GiB deviceMemoryBandwidth: 707.88GiB/s
2022-09-20 23:43:19.546140: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 1 with properties: 
pciBusID: 0000:89:00.0 name: NVIDIA GeForce RTX 3080 computeCapability: 8.6
coreClock: 1.71GHz coreCount: 68 deviceMemorySize: 9.78GiB deviceMemoryBandwidth: 707.88GiB/s
2022-09-20 23:43:19.546425: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 2 with properties: 
pciBusID: 0000:b2:00.0 name: NVIDIA GeForce RTX 3080 computeCapability: 8.6
coreClock: 1.755GHz coreCount: 68 deviceMemorySize: 9.78GiB deviceMemoryBandwidth: 707.88GiB/s
2022-09-20 23:43:19.547856: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2022-09-20 23:43:19.552415: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2022-09-20 23:43:19.556670: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2022-09-20 23:43:19.558512: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2022-09-20 23:43:19.562736: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2022-09-20 23:43:19.565684: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2022-09-20 23:43:19.573056: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2022-09-20 23:43:19.574676: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0, 1, 2
2022-09-20 23:43:19.575740: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2022-09-20 23:43:19.589146: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 1900000000 Hz
2022-09-20 23:43:19.590042: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5618e9f68fa0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2022-09-20 23:43:19.590074: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2022-09-20 23:43:19.822084: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5618e9fdef30 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-09-20 23:43:19.822135: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): NVIDIA GeForce RTX 3080, Compute Capability 8.6
2022-09-20 23:43:19.822146: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (1): NVIDIA GeForce RTX 3080, Compute Capability 8.6
2022-09-20 23:43:19.822154: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (2): NVIDIA GeForce RTX 3080, Compute Capability 8.6
2022-09-20 23:43:19.822933: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:3e:00.0 name: NVIDIA GeForce RTX 3080 computeCapability: 8.6
coreClock: 1.71GHz coreCount: 68 deviceMemorySize: 9.78GiB deviceMemoryBandwidth: 707.88GiB/s
2022-09-20 23:43:19.823216: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 1 with properties: 
pciBusID: 0000:89:00.0 name: NVIDIA GeForce RTX 3080 computeCapability: 8.6
coreClock: 1.71GHz coreCount: 68 deviceMemorySize: 9.78GiB deviceMemoryBandwidth: 707.88GiB/s
2022-09-20 23:43:19.823496: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 2 with properties: 
pciBusID: 0000:b2:00.0 name: NVIDIA GeForce RTX 3080 computeCapability: 8.6
coreClock: 1.755GHz coreCount: 68 deviceMemorySize: 9.78GiB deviceMemoryBandwidth: 707.88GiB/s
2022-09-20 23:43:19.823547: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2022-09-20 23:43:19.823565: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2022-09-20 23:43:19.823579: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2022-09-20 23:43:19.823593: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2022-09-20 23:43:19.823607: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2022-09-20 23:43:19.823621: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2022-09-20 23:43:19.823637: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2022-09-20 23:43:19.825027: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0, 1, 2
2022-09-20 23:43:19.825067: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2022-09-20 23:43:19.826502: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-09-20 23:43:19.826520: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 1 2 
2022-09-20 23:43:19.826533: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N N N 
2022-09-20 23:43:19.826540: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 1:   N N N 
2022-09-20 23:43:19.826548: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 2:   N N N 
2022-09-20 23:43:19.827684: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 9215 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 3080, pci bus id: 0000:3e:00.0, compute capability: 8.6)
2022-09-20 23:43:19.828531: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 9215 MB memory) -> physical GPU (device: 1, name: NVIDIA GeForce RTX 3080, pci bus id: 0000:89:00.0, compute capability: 8.6)
2022-09-20 23:43:19.829330: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 9215 MB memory) -> physical GPU (device: 2, name: NVIDIA GeForce RTX 3080, pci bus id: 0000:b2:00.0, compute capability: 8.6)
usage: training.py [-h] [--batch_size BATCH_SIZE] [--epochs EPOCHS] [--lr LR]
                   [--loss LOSS]
                   [--loss_weights LOSS_WEIGHTS [LOSS_WEIGHTS ...]]
                   [--shuffle_buffer_size SHUFFLE_BUFFER_SIZE]
training.py: error: unrecognized arguments: --loss_weigths 0.01 0.5 0.7
